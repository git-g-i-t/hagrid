# 实验参数
epochs: 100  # 训练总轮数
log_every: 100  # 每100次迭代记录一次日志
eval_every: 1  # 每1个epoch进行一次验证并保存模型
test_every: 0  # 每0个epoch进行一次测试（0表示不进行定期测试）
experiment_name: ConvNeXt_base  # 实验名称
work_dir: work_dir  # 工作目录，用于保存模型和日志

# 早停设置
early_stopping:
    epochs: 10  # 如果验证集指标在10个epoch内没有提升，则停止训练
    metric: 0.01  # 指标提升的最小阈值

# 数据集配置
dataset:
    annotations_train: "annotations_mini/train"
    annotations_val: "annotations_mini/val"
    annotations_test: "annotations_mini/test"

    dataset_train: "dataset_mini/train"
    dataset_val: "dataset_mini/val"
    dataset_test: "dataset_mini/test"

    img_size: &img_size 224  # 训练图像尺寸，必须是正方形
    img_mean: &img_mean [0.54, 0.499, 0.474]  # 图像归一化均值 [R, G, B]
    img_std: &img_std [0.234, 0.235, 0.231]  # 图像归一化标准差 [R, G, B]
    subset: -1  # 训练数据子集大小（-1表示使用全部数据）

    one_class: False  # 是否使用单类别分类

    # 手势类别标签列表
    targets:
        - grabbing  # 抓取
        - grip  # 握拳
        - holy  # 祈祷手势
        - point  # 指向
        - call  # 召唤手势
        - three3  # 数字三手势3
        - timeout  # 暂停手势
        - xsign  # X标记
        - hand_heart  # 爱心手势1
        - hand_heart2  # 爱心手势2
        - little_finger  # 小拇指
        - middle_finger  # 中指标记
        - take_picture  # 拍照手势
        - dislike  # 不喜欢
        - fist  # 拳头
        - four  # 数字四
        - like  # 点赞
        - mute  # 静音
        - ok  # OK手势
        - one  # 数字一
        - palm  # 手掌
        - peace  # 和平手势
        - peace_inverted  # 反向和平手势
        - rock  # 摇滚手势
        - stop  # 停止
        - stop_inverted  # 反向停止
        - three  # 数字三
        - three2  # 数字三手势2
        - two_up  # 双指向上
        - two_up_inverted  # 反向双指向上
        - three_gun  # 三指枪手势
        - thumb_index  # 拇指食指手势1
        - thumb_index2  # 拇指食指手势2
        - no_gesture  # 无手势

# 训练数据增强和变换管道（使用albumentations库）
train_transforms:
    LongestMaxSize:  # 将图像的最长边缩放到指定大小
        max_size: *img_size
        p: 1  # 应用概率为100%
    PadIfNeeded:  # 如果图像尺寸小于指定尺寸，则进行填充
        min_height: *img_size
        min_width: *img_size
        value: [144,144,144]  # 填充颜色（RGB）
        border_mode: 0  # 边框类型
        p: 1
    Normalize:  # 图像归一化
        mean: *img_mean
        std: *img_std
        max_pixel_value: 255.0
        p: 1

# 验证集数据变换（通常不包含数据增强）
val_transforms:
    LongestMaxSize:
        max_size: *img_size
        p: 1
    PadIfNeeded:
        min_height: *img_size
        min_width: *img_size
        value: [144,144,144]
        border_mode: 0
        p: 1
    Normalize:
        mean: *img_mean
        std: *img_std
        max_pixel_value: 255.0
        p: 1

# 测试集数据变换
test_transforms:
    LongestMaxSize:
        max_size: *img_size
        p: 1
    PadIfNeeded:
        min_height: *img_size
        min_width: *img_size
        value: [144,144,144]
        border_mode: 0
        p: 1
    Normalize:
        mean: *img_mean
        std: *img_std
        max_pixel_value: 255.0
        p: 1

# 模型参数配置
model:
    name: ConvNeXt_base  # 模型名称
    pretrained: False  # 是否使用预训练模型（完整模型）
    pretrained_backbone: False  # 是否使用预训练骨干网络
    checkpoint: null  # 模型检查点路径（null表示不加载）

# 优化器配置
optimizer:
    name: AdamW  # 优化器类型
    params:
        lr: 0.004  # 学习率
        weight_decay: 0.05  # 权重衰减（L2正则化）
        eps: 0.00000001  # 数值稳定项

# 学习率调度器配置
# 临时注释掉调度器部分
# scheduler:
#     name: Warmup_Cosine
#     name_warmup: LinearLR
#     start_factor: 0.001
#     name_scheduler: CosineAnnealingLR
#     params:
#         T_max: 8
#     warmup_epochs: 5
scheduler:
    name: CosineAnnealingLR
    params:
        T_max: 100  # 总epoch数
        eta_min: 0.0001  # 最小学习率

criterion: CrossEntropyLoss  # 损失函数：交叉熵损失

# 训练参数配置
train_params:
    num_workers: 16  # 数据加载的工作进程数
    shuffle: True  # 是否打乱训练数据
    batch_size: 128  # 训练批次大小
    prefetch_factor: 3  # 数据预加载因子

# 测试参数配置
test_params:
    num_workers: 16
    shuffle: False  # 测试时不打乱数据
    batch_size: 128
    prefetch_factor: 3

# 验证参数配置
val_params:
    num_workers: 16
    shuffle: False  # 验证时不打乱数据
    batch_size: 128
    prefetch_factor: 3